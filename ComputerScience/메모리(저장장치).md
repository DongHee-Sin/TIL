# 메모리 (저장장치)
모든 프로그램은 메모리(RAM / 주기억장치)에 올라와야 실행이 가능하다. (폰노이만 구조)<br/>
메모리에는 실행에 필요한 프로그램과 데이터가 올라오며, CPU와 협업하여 작업이 이루어진다.

<br/>

## 메모리 계층 구조
메모리 계층 구조란 메모리(저장장치)를 필요에 따라 여러 종류로 나눈 것을 의미한다. <br/>
상위 계층일수록 속도가 빠르고, 하위 계층일수록 용량이 크다.<br>

![메모리 계층 구조](/image/%EB%A9%94%EB%AA%A8%EB%A6%AC%20%EA%B3%84%EC%B8%B5%20%EA%B5%AC%EC%A1%B0.png)

<br/>

### 레지스터
* CPU 안에 존재하는 작은 메모리로, 휘발성 메모리이다.
* 메모리 중 속도가 가장 빠르고, 저장 공간이 가장 적다.
* 용도에 따라 전용 레지스터, 범용 레지스터로 구분되고, 저장되는 정보의 종류에 따라 데이터 레지스터와 주소 레지스터, 상태 레지스터로 나뉜다.

<br/>

### 캐시
* 속도와 크기에 따라 L1, L2, L3캐시로 분류되며, 휘발성 메모리이다.
* CPU와 RAM 사이에 위치하며, 속도가 빠르지만 용량이 적고 비싸다.

<br/>

### 메모리 (RAM, 주기억장치)
* 휘발성 메모리로, 보조기억장치에 저장된 프로그램이 실행되기 위해서는 RAM에 올라와서 프로세스가 되어야 한다.
* 일반적으로 메모리라고 하면 RAM/주기억장치를 의미하지만, 구체적으로 메모리는 RAM과 ROM으로 구분된다.

<br/>

### 하드 디스크 (저장장치, 보조기억장치)
* HDD, SSD를 말하며, 비휘발성 메모리이다.
* 속도가 느리지만, 용량이 크고 상대적으로 저렴하다.

<br/>
<br/>

---

<br/>
<br/>

## 캐시
데이터를 미리 복사해 놓는 임시 저장소이자 빠른 장치와 느린 장치 사이에서 속도 차이에 따른 병목 현상을 완화하기 위한 메모리를 말한다. <br/>
캐시 메모리를 통해 데이터에 접근하는 시간과 무언가를 다시 계산하는 시간을 절약할 수 있다.

<br/>

실제로 CPU와 주기억장치 사이의 속도 차이가 크기 때문에 레지스터 계층을 두어 속도 차이를 해결하고, 이렇게 속도 차이를 해결하기 위해 계층과 계층 사이에 존재하는 계층을 캐싱 계층이라고 부른다. <br/>
캐시 메모리와 보조기억장치 사이에 존재하는 주기억장치(RAM) 또한 두 계층의 속도 차이를 완화해주는 캐싱 계층이다.

> 데이터베이스의 캐싱 계층 : <br/>
> DB 시스템을 구축할 때도 메인 데이터베이스 위에 [레디스(redis)](https://ko.wikipedia.org/wiki/레디스) 데이터베이스 계층을 "캐싱 계층"으로 둬서 성능을 향상시키기도 한다.

<br/>
<br/>


### 캐시 메모리
CPU가 주기억장치(RAM)에 저장된 데이터를 읽어올 때, 자주 사용하는 데이터를 캐시 메모리에 저장해둔 후, 다시 해당 데이터가 필요해지는 순간에는 주기억장치가 아닌 캐시 메모리에서 데이터를 가져오면서 속도를 향상시킨다. <br/>
자주 사용하는 데이터에 대한 근거는 "지역성"으로 판단하며, **시간 지역성**과 **공간 지역성**으로 나뉜다.

<br/>

### 시간 지역성
최근 사용한 데이터에 다시 접근하려는 특성을 말한다. <br/>
for문, while문 같은 반복문에서 사용된 변수는 다시 사용될 가능성이 높다.

<br/>

### 공간 지역성
최근 접근한 데이터를 이루고 있는 공간이나, 해당 공간에 가깝게 있는 공간으로 접근하는 특성을 말한다. (최근 사용된 데이터와 인접한 데이터가 다시 사용될 가능성이 높다는 것) <br/>
arr[0], arr[1] 처럼 배열의 데이터에 연속적으로 접근하는 경우를 말한다.

<br/>
<br/>
<br/>

## 캐시히트와 캐시미스
CPU가 캐시 메모리에서 원하는 데이터를 찾은 것을 "**캐시히트**"라고 하며, 원하는 데이터가 캐시 메모리에 없는 경우 주기억장치로 이동하여 데이터를 찾는데 이것을 "**캐시미스**"라고 부른다.

<br/>

**캐시히트**가 되면 CPU와 위치도 가깝고, CPU 내부 버스를 기반으로 동작하기 때문에 속도가 빠르다. <br/>
**캐시미스**가 발생하면 시스템 버스를 기반으로 주기억장치에서 데이터를 가져오기 떄문에 속도가 느려진다.

<br/>
<br/>
<br/>

## 캐시매핑
캐시가 히트되기 위해 매핑하는 방법을 말하며, CPU의 레지스터와 주기억장치 간 데이터를 주고받을 때를 기반으로 설명한다. <br/>
캐시 메모리가 레지스터와 주기억장치 사이에서 캐싱 계층으로써 역할을 잘 수행하기 위해서는 **캐시매핑**을 어떻게 하느냐가 중요하다.

<br/>

|이름|설명|
|------|---|
|직접 매핑|메모리가 1~100이 있고 캐시가 1~10이 있다면 1:1~10, 2:1~10 ... 이런 방식으로 메모리 주소와 캐시 순서를 일치시키는 방식이다.<br/>매핑 처리가 빠르지만 충돌 가능성이 높고, 적중률이 낮다.|
|연관 매핑|순서를 일치시키지 않고 관련 있는 캐시와 메모리를 매핑한다.<br/>충돌이 적지만 모든 블록을 탐색해야 하기 때문에 속도가 느리다.|
|집합 연관 매핑|직접 매핑과 연관 매핑을 결합시킨 형태로, 순서는 일치시키지만 집합을 두어 저장하며 블록화되어 있기 때문에 검색이 좀 더 효율적이다. <br/>메모리가 1~100이 있고 캐시가 1~10이 있다면 캐시 1~5에는 메모리 1~50의 데이터를 무작위로 저장한다.|

<br/>
<br/>

---

<br/>
<br/>

## 웹 브라우저의 캐시
소프트웨어적인 캐시는 대표적으로 웹 브라우저의 저장소 쿠키, 로컬 스토리지, 세션 스토리지가 있다. <br/>
이런 캐시들은 보통 사용자의 커스텀한 정보나 인증 모듈 관련 사항들을 웹 브라우저에 저장해서 추후 서버에 요청할 때 사용자임을 알리는 아이덴티티나 중복 요청 방지를 위해 사용된다.

<br/>
<br/>

### (웹 브라우저의) 쿠키
* 만료기한이 있는 키-값 형태의 저장소이다. 
* 4KB까지 데이터를 저장할 수 있고, 만료기한을 정할 수 있다.
* 쿠키의 만료기한은 일반적으로 서버에서 정한다. (클라이언트에서도 정할 수 있음)

<br/>

### 로컬 스토리지
* 만료기한이 없는 키-값 형태의 저장소이다.
* 10MB까지 저장할 수 있으며 웹 브라우저를 닫아도 데이터가 유지되고, 도메인 단위로 저장/생성된다.
* HTML5를 지원하는 웹 브라우저에서만 사용 가능하고, 클라이언트에서만 수정할 수 있다.

<br/>

### 세션 스토리지
* 만료기한이 없는 키-값 형태의 저장소이다.
* 웹 브라우저의 탭 단위로 세션 스토리지를 생성하며, 탭을 닫으면 해당 데이터가 삭제된다.
* 5MB까지 저장할 수 있고, HTML5를 지원하는 웹 브라우저에서만 사용할 수 있다.
* 클라이언트에서만 수정할 수 있다.