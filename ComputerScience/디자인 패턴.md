# 디자인 패턴
* 프로그램을 설계할 때 발생했던 문제점들을 객체 간의 상호 관계 등을 이용하여 해결할 수 있도록 하나의 "규약" 형태로 만든 것
* 프로그램 개발에서 자주 나타나는 문제를 해결하기 위한 방법

<br/>

### 종류
* [싱글톤 패턴](#싱글톤-패턴)
* [팩토리 패턴](#팩토리-패턴)

<br/>
<br/>

---

<br/>
<br/>

## 싱글톤 패턴
* 하나의 클래스에 하나의 인스턴스만 가지도록 하는 패턴
* 유일하게 한개만 존재하는 객체가 필요한 경우에 사용한다.
* 인스턴스를 클래스의 타입 프로퍼티로 저장하기 때문에 생성 후 앱이 종료되기 전까지 메모리에서 해제되지 않는다. (데이터 영역에 저장)

<br/>

### 장점
* 하나의 인스턴스를 생성하고, 여러 곳에서 공유하며 사용하기 때문에 인스턴스를 생성할 때 드는 비용이 줄어든다.
* 싱글톤 객체는 전역으로 사용되어 다른 클래스들과 자원 공유가 간편하다.
* DBCP(DataBase Connection Pool)처럼 공통된 객체를 여러개 생성해서 사용해야하는 상황에서 많이 사용된다.

<br/>

### 단점
* 하나의 인스턴스를 여러 곳에서 공유하므로 의존성이 높아진다. ([의존성 주입](https://ko.wikipedia.org/wiki/의존성_주입)을 통해 모듈 간의 결합을 조금 해결할 수 있다.)
* TDD(Test Driven Development)를 할 때 걸림돌이 된다.
   * TDD를 할 때 단위 테스트를 주로 하는데, 단위 테스트는 테스트가 서로 독립적이어야 한다. 싱글톤 패턴은 미리 생성된 하나의 인스턴스를 기반으로 구현되기 때문에, 각 테스트마다 "독립적인 인스턴스"를 만들기 어렵다.

<br/>

> [TDD](https://ko.wikipedia.org/wiki/테스트_주도_개발) : 매우 짧은 개발 사이클을 반복하는 소프트웨어 개발 프로세스 중 하나이다. 개발자는 먼저 요구사항을 검증하는 테스트 케이스를 작성하고, 해당 테스트 케이스를 통과하기 위한 최소한의 코드를 작성한다. 마지막으로 작성한 코드를 표준에 맞도록 리팩토링한다.


<br/>

### 싱글톤이 필요한 경우
* 공유할 필요가 있는 특정 데이터를 관리할 객체가 필요한 경우 (ex- 유저 로그인 정보 ..)
* 데이터베이스 연결 모듈로써 사용

<br/>
<br/>

### 싱글톤 예시
```swift
class Singleton {
    // 저장 타입 프로퍼티로 (자기 자신의)인스턴스 생성
    static let shared = Singleton()
    
    var userInfoId: Int = 12345
    
    // 생성자를 private처리하여 인스턴스가 다른곳에서 생성되는 것을 방지 (선택)
    private init() {}
    
}


// shared로 접근하는 순간 메모리(데이터 영역)에 올라간다.
// object1, 2에는 싱글톤 인스턴스의 메모리 주소가 저장됨
let object1 = Singleton.shared
let object2 = Singleton.shared

object1.userInfoId = 54321
object2.userInfoId  // 54321
```

<br/>
<br/>

---

<br/>
<br/>

## 팩토리 패턴
* 객체를 사용하는 코드에서 객체 생성 부분(이니셜라이저)을 떼어내 추상화한 패턴
* 상속 관계에 있는 두 클래스에서 상위 클래스가 중요한 뼈대를 결정하고, 하위 클래스에서 객체 생성에 관한 구체적인 내용을 결정하는 패턴
* 팩토리 메서드를 통해 인스턴스를 생성한다.


<br/>

### 장점
* 상위 클래스와 하위 클래스가 분리되기 때문에 느슨한 결합을 갖는다.
* 상위 클래스는 인스턴스 생성 방식에 대해 알 필요가 없기 때문에 더 많은 유연성을 갖는다.
* 기존 코드에서 생성자 메서드에 변화가 생기는 경우(내부 구현의 변화) 해당 생성자를 사용하던 모든 곳에서 수정이 필요했는데, 팩토리 패턴을 사용하면 팩토리 메서드만 수정하면 된다.
* 새로운 기능이 추가되어도 팩토리 메서드를 통해 새로운 인스턴스를 생성하기 쉽다.

<br/>
<br/>

### 팩토리 패턴 예시
```swift
class Product {
    var name: String
    
    init(name: String) {
        self.name = name
    }
}


class Factory {
    static func getInstance(name: String) -> Product {
        return Product(name: name)
    }
}


// 팩토리 클래스를 통해 인스턴스 생성
let productInstance = Factory.getInstance(name: "팩토리 예시")
```