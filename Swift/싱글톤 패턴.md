# 싱글톤 패턴
유일하게 한개만 존재하는 객체가 필요한 경우에 사용한다. (특정 유일한 데이터를 관리할 객체가 필요한 경우) <br/>
한번 생성되면 앱이 종료되기 전까지 메모리에서 해제되지 않는 인스턴스를 하나만 생성하고, 프로그램 전체에서 공유하며 사용한다.<br/>

<br/>

```swift
class Singleton {
    // 저장 타입 프로퍼티로 (자기 자신의)인스턴스 생성
    static let shared = Singleton()
    
    var userInfoId: Int = 12345
    
    // 생성자를 private처리하여 인스턴스가 다른곳에서 생성되는 것을 방지 (선택)
    private init() {}
    
}


// shared로 접근하는 순간 메모리(데이터 영역)에 올라간다.
// object에는 싱글톤 인스턴스의 메모리 주소가 저장됨
let object1 = Singleton.shared
let object2 = Singleton.shared

object1.userInfoId = 54321

object2.userInfoId   // 54321
```

* 위 코드에서 shared 상수는 메모리의 데이터 영역에 생성되고, 힙 영역에 생성되는 인스턴스의 주소를 참조한다. 
* 데이터 영역은 앱이 종료되기 전까지 메모리에서 해제되지 않으므로, 힙 영역에 생성된 인스턴스의 ReferenceCount는 0이 되지 않고, 메모리에서 해제되지 않는 것
* 하나의 인스턴스를 여러 곳에서 참조하여 사용해야 하므로, 클래스(참조 타입)로 구현한다.
* static let으로 (상수로) 인스턴스의 주소를 저장. 이 상수를 통해 인스턴스에 접근해야 하기 때문에 값이 변하면 안됨
* 타입 저장 프로퍼티는 기본적으로 lazy하게 동작하여, shared(공유 인스턴스)에 접근하는 순간 메모리(데이터 영역)에 올라간다.

<br/>
<br/>

### 사용 예시 :
```swift
UserDefaults.standard        // 사용자 기본 설정과 같은 단일 데이터 저장소 - 한번 생성된 후, 메모리에 계속 남음
UIApplication.shared         // 앱이 실행되는 동안, 앱을 제어하는 인스턴스
NotificationCenter.default   // 알림을 통해, 다른 객체간에 정보 전달
```

<br/>

---

<br/>

### 싱글톤이 필요한 경우
* 유저 로그인 정보를 여러 View에서 접근하고, 사용해야 하는 경우

<br/>
<br/>

### 싱글톤 패턴 vs 타입 프로퍼티
#### 비슷한 기능을 수행할 수 있겠지만, 싱글톤을 사용하면 shared를 통해 쉽게 데이터에 접근이 가능한 반면, 타입 프로퍼티(+메서드)를 사용하면 매번 타입을 통해 값에 접근해야하는 번거로움이 발생

<br/>
<br/>

---

<br/>
<br/>

## 싱글톤 장점
* 인스턴스를 하나만 생성하여 공유하기 때문에 메모리 낭비를 방지
* 메모리를 할당하고 초기화하는 과정이 한 번만 실행되기 때문에 인스턴스에 접근하는 시간이 개선됨
* 싱글톤 객체는 전역으로 사용되어 다른 클래스들과 자원 공유가 간편함
* DBCP(DataBase Connection Pool)처럼 공통된 객체를 여러개 생성해서 사용해야하는 상황에서 많이 사용됨

<br/>

## 싱글톤 단점
* 싱글톤 객체가 너무 많은 일을 하거나, 너무 많은 데이터를 공유시킬 경우 다른 클래스의 인스턴스들 간에 결합도가 높아져서 "개방=폐쇄"원칙을 위배함 (객체지향적이지 못함)
* 위와같은 문제가 생기면 수정과 테스트가 어려워짐
* 하나의 인스턴스를 공유해서 사용하기 때문에, 멀티 스레드 환경에서 공유자원의 문제가 발생할 수 있다.